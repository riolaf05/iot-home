[{"id":"28db1ee.fa9eae2","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"b8deeead.b03ce","type":"mqtt-broker","z":"","name":"smart_garden_status","broker":"192.168.1.0","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"7b6f146.b6f78ec","type":"MySQLdatabase","z":"","host":"192.168.1.1","port":"3306","db":"SmartGarden","tz":""},{"id":"367a56e6.6037ea","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"dfa8f8ef.189dc8","type":"ui_tab","z":"","name":"My edge-gateway","icon":"device_hub","order":2,"disabled":false,"hidden":false},{"id":"ffe2a82.7701d58","type":"ui_group","z":"","name":"Buttons","tab":"dfa8f8ef.189dc8","order":1,"disp":true,"width":"6","collapse":false},{"id":"86faef57.95f66","type":"ui_group","z":"","name":"Gauges","tab":"dfa8f8ef.189dc8","order":2,"disp":true,"width":"6","collapse":false},{"id":"dd53d2bd.2b31","type":"ui_tab","z":"","name":"IoT Devices","icon":"dashboard","order":1,"disabled":false,"hidden":false},{"id":"22c25644.faa99a","type":"mqtt-broker","z":"","name":"Mosquitto Broker","broker":"192.168.1.0","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"c1d6f737.00ece8","type":"ui_group","z":"","name":"Gauges","tab":"dd53d2bd.2b31","disp":true,"width":"6","collapse":false},{"id":"36781658.5a5e4a","type":"telegram bot","z":"","botname":"T.A.N.I.A.","usernames":"","chatids":"","baseapiurl":"","updatemode":"polling","pollinterval":"300","usesocks":false,"sockshost":"","socksport":"6667","socksusername":"anonymous","sockspassword":"","bothost":"","localbotport":"8443","publicbotport":"8443","privatekey":"","certificate":"","useselfsignedcertificate":false,"sslterminated":false,"verboselogging":false},{"id":"8fb33757.55d228","type":"mqtt in","z":"28db1ee.fa9eae2","name":"smart_garden_subscriber","topic":"smart_garden_status","qos":"0","datatype":"auto","broker":"b8deeead.b03ce","x":230,"y":300,"wires":[["10556196.f15b4e"]]},{"id":"10556196.f15b4e","type":"function","z":"28db1ee.fa9eae2","name":"create_query","func":"msg.topic = \"INSERT INTO Smart_Garden_Status (ID, Name, Timestamp, Status) VALUES (null, 'smart_garden', CURRENT_TIME(), '\" + msg.payload + \"');\";\nreturn msg;","outputs":1,"noerr":0,"x":460,"y":300,"wires":[["6d72e0c1.6d0e"]]},{"id":"6d72e0c1.6d0e","type":"mysql","z":"28db1ee.fa9eae2","mydb":"7b6f146.b6f78ec","name":"insert_query","x":740,"y":300,"wires":[[]]},{"id":"8b9e1c36.22c9e","type":"inject","z":"28db1ee.fa9eae2","name":"10_min_trigger","topic":"smart_garden_status","payload":"OFF","payloadType":"str","repeat":"600","crontab":"","once":false,"onceDelay":0.1,"x":220,"y":360,"wires":[["88cf158.9010ce8"]]},{"id":"88cf158.9010ce8","type":"function","z":"28db1ee.fa9eae2","name":"reset_status","func":"msg.topic = \"INSERT INTO Smart_Garden_Status (ID, Name, Timestamp, Status) VALUES (null, 'smart_garden', CURRENT_TIME(), '\" + msg.payload + \"');\";\nreturn msg;","outputs":1,"noerr":0,"x":430,"y":360,"wires":[["6d72e0c1.6d0e"]]},{"id":"9f89618.ba3a8a","type":"comment","z":"28db1ee.fa9eae2","name":"led-status","info":"This allows to read from \n`smart_garden_status` topic (which is updated by MQTT device, e.g. ESP8266) and store informations about device status (on, off). ","x":180,"y":260,"wires":[]},{"id":"6504bfba.52d9d","type":"comment","z":"28db1ee.fa9eae2","name":"buttons","info":"","x":170,"y":560,"wires":[]},{"id":"4ab02f3d.3572e","type":"ui_switch","z":"28db1ee.fa9eae2","name":"","label":"Camera","tooltip":"","group":"ffe2a82.7701d58","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"str","onicon":"","oncolor":"","offvalue":"false","offvalueType":"str","officon":"","offcolor":"","x":180,"y":620,"wires":[["1f9aea50.991c46"]]},{"id":"ef202a3b.c45e38","type":"ui_switch","z":"28db1ee.fa9eae2","name":"","label":"Motion_sensor","tooltip":"","group":"ffe2a82.7701d58","order":2,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":460,"y":1100,"wires":[[]]},{"id":"c197e70.59e4d18","type":"ui_button","z":"28db1ee.fa9eae2","name":"","group":"ffe2a82.7701d58","order":4,"width":0,"height":0,"passthru":false,"label":"Minidlna_restart","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":260,"y":1100,"wires":[[]]},{"id":"350e592f.d65366","type":"ui_switch","z":"28db1ee.fa9eae2","name":"","label":"Light","tooltip":"","group":"ffe2a82.7701d58","order":3,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":250,"y":1160,"wires":[[]]},{"id":"7678edda.5dd014","type":"ui_button","z":"28db1ee.fa9eae2","name":"","group":"ffe2a82.7701d58","order":6,"width":0,"height":0,"passthru":false,"label":"Anti-theft-mode","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":280,"y":1220,"wires":[[]]},{"id":"1f9aea50.991c46","type":"http request","z":"28db1ee.fa9eae2","name":"","method":"POST","ret":"txt","paytoqs":true,"url":"192.168.1.10:5002/docker","tls":"","persist":false,"proxy":"","authType":"","x":450,"y":620,"wires":[["c02b09c4.d852a8"]]},{"id":"c02b09c4.d852a8","type":"debug","z":"28db1ee.fa9eae2","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":710,"y":620,"wires":[]},{"id":"2046ed4.3a86712","type":"http request","z":"28db1ee.fa9eae2","name":"Raspberry2_temperature","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.10:5002/temperature","tls":"","persist":false,"proxy":"","authType":"","x":490,"y":780,"wires":[["7ac61973.0880a8"]]},{"id":"7ac61973.0880a8","type":"ui_gauge","z":"28db1ee.fa9eae2","name":"","group":"86faef57.95f66","order":2,"width":0,"height":0,"gtype":"gage","title":"Raspberry 2 Temperature","label":"C°","format":"{{value}}","min":0,"max":"80","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":750,"y":780,"wires":[]},{"id":"8771a9d5.459fe8","type":"inject","z":"28db1ee.fa9eae2","name":"","topic":"","payload":"","payloadType":"date","repeat":"5","crontab":"","once":true,"onceDelay":"5","x":190,"y":780,"wires":[["2046ed4.3a86712"]]},{"id":"9bd47b92.a1b4d8","type":"inject","z":"28db1ee.fa9eae2","name":"","topic":"","payload":"","payloadType":"date","repeat":"5","crontab":"","once":true,"onceDelay":"5","x":190,"y":740,"wires":[["2cd9ff4d.b7519"]]},{"id":"2cd9ff4d.b7519","type":"http request","z":"28db1ee.fa9eae2","name":"Raspberry1_temperature","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.9:5002/temperature","tls":"","persist":false,"proxy":"","authType":"","x":490,"y":740,"wires":[["19911c3b.a2c724"]]},{"id":"19911c3b.a2c724","type":"ui_gauge","z":"28db1ee.fa9eae2","name":"","group":"86faef57.95f66","order":1,"width":0,"height":0,"gtype":"gage","title":"Raspberry 1 Temperature","label":"C°","format":"{{value}}","min":0,"max":"80","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":750,"y":740,"wires":[]},{"id":"21ddcf57.197dc","type":"comment","z":"28db1ee.fa9eae2","name":"dashboard","info":"","x":160,"y":700,"wires":[]},{"id":"73b1d52e.83e99c","type":"http request","z":"28db1ee.fa9eae2","name":"Raspberry1_memory","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.9:5002/memory","tls":"","persist":false,"proxy":"","authType":"","x":480,"y":860,"wires":[["acafce71.36a09"]]},{"id":"acafce71.36a09","type":"ui_gauge","z":"28db1ee.fa9eae2","name":"","group":"86faef57.95f66","order":3,"width":0,"height":0,"gtype":"donut","title":"Raspberry 1 Memory","label":"GB","format":"{{value}}","min":0,"max":"16","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":740,"y":860,"wires":[]},{"id":"a1acd6fd.c39728","type":"inject","z":"28db1ee.fa9eae2","name":"","topic":"","payload":"","payloadType":"date","repeat":"5","crontab":"","once":true,"onceDelay":"5","x":190,"y":860,"wires":[["73b1d52e.83e99c"]]},{"id":"4b81682.c813598","type":"http request","z":"28db1ee.fa9eae2","name":"Raspberry2_memory","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.10:5002/memory","tls":"","persist":false,"proxy":"","authType":"","x":480,"y":900,"wires":[["da092276.ad7de"]]},{"id":"da092276.ad7de","type":"ui_gauge","z":"28db1ee.fa9eae2","name":"","group":"86faef57.95f66","order":4,"width":0,"height":0,"gtype":"donut","title":"Raspberry 2 Memory","label":"GB","format":"{{value}}","min":0,"max":"32","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":740,"y":900,"wires":[]},{"id":"50effb8.7a39504","type":"inject","z":"28db1ee.fa9eae2","name":"","topic":"","payload":"","payloadType":"date","repeat":"5","crontab":"","once":true,"onceDelay":"5","x":190,"y":900,"wires":[["4b81682.c813598"]]},{"id":"6a40d359.8a3ffc","type":"http request","z":"28db1ee.fa9eae2","name":"Raspberry1_hard_disk","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.9:5002/harddisk","tls":"","persist":false,"proxy":"","authType":"","x":480,"y":980,"wires":[["f13f8689.98fa58"]]},{"id":"f13f8689.98fa58","type":"ui_gauge","z":"28db1ee.fa9eae2","name":"","group":"86faef57.95f66","order":5,"width":0,"height":0,"gtype":"donut","title":"Raspberry 1 Hard Disk","label":"GB","format":"{{value}}","min":0,"max":"300","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":740,"y":980,"wires":[]},{"id":"c3fd20b1.4074a","type":"inject","z":"28db1ee.fa9eae2","name":"","topic":"","payload":"","payloadType":"date","repeat":"5","crontab":"","once":true,"onceDelay":"5","x":190,"y":980,"wires":[["6a40d359.8a3ffc"]]},{"id":"7017f493.6b349c","type":"http request","z":"28db1ee.fa9eae2","name":"","method":"GET","ret":"txt","paytoqs":true,"url":"192.168.1.10:5002/ainews","tls":"","persist":false,"proxy":"","authType":"","x":450,"y":660,"wires":[["6729aef4.e366e"]]},{"id":"6729aef4.e366e","type":"debug","z":"28db1ee.fa9eae2","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":710,"y":660,"wires":[]},{"id":"67dcd273.6c280c","type":"ui_button","z":"28db1ee.fa9eae2","name":"","group":"ffe2a82.7701d58","order":5,"width":0,"height":0,"passthru":false,"label":"AI News","tooltip":"","color":"","bgcolor":"","icon":"","payload":"true","payloadType":"bool","topic":"","x":180,"y":660,"wires":[["7017f493.6b349c"]]},{"id":"581c6d2a.fda4b4","type":"comment","z":"28db1ee.fa9eae2","name":"IoT Device - Smart Garden","info":"","x":190,"y":1320,"wires":[]},{"id":"4e553107.c367c","type":"mqtt in","z":"28db1ee.fa9eae2","name":"","topic":"moisture","qos":"1","datatype":"auto","broker":"22c25644.faa99a","x":140,"y":1380,"wires":[["dfd1d36d.3e746","45c9cadd.33e764"]]},{"id":"9107dcd1.2be96","type":"mqtt in","z":"28db1ee.fa9eae2","name":"","topic":"temperature","qos":"2","datatype":"auto","broker":"22c25644.faa99a","x":150,"y":1520,"wires":[["12fe829f.f1c82d","6f26e2f8.613cec"]]},{"id":"dfd1d36d.3e746","type":"ui_gauge","z":"28db1ee.fa9eae2","name":"","group":"c1d6f737.00ece8","order":1,"width":0,"height":0,"gtype":"wave","title":"Umidità terreno","label":"%","format":"{{value}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":540,"y":1380,"wires":[]},{"id":"45c9cadd.33e764","type":"function","z":"28db1ee.fa9eae2","name":"Moisture trigger","func":"var payload  = msg.payload;\nmsg.payload = {}\nmoisture=msg.payload.content \nmsg.payload.chatId = -1001429479181\nmsg.payload.type = 'message'\nmsg.payload.content = 'Umidità ' + payload + \"%\"\n\n//msg.payload = payload[0];\nreturn msg;\n\n","outputs":1,"noerr":0,"x":340,"y":1440,"wires":[["1ffea8a3.31c527"]]},{"id":"1ffea8a3.31c527","type":"telegram sender","z":"28db1ee.fa9eae2","name":"Send alarm","bot":"36781658.5a5e4a","x":530,"y":1440,"wires":[[]]},{"id":"12fe829f.f1c82d","type":"ui_gauge","z":"28db1ee.fa9eae2","name":"","group":"c1d6f737.00ece8","order":2,"width":0,"height":0,"gtype":"gage","title":"Temperatura","label":"° C","format":"{{value}}","min":0,"max":"30","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":530,"y":1520,"wires":[]},{"id":"6f26e2f8.613cec","type":"function","z":"28db1ee.fa9eae2","name":"Moisture trigger","func":"var payload  = msg.payload;\nmsg.payload = {}\nmoisture=msg.payload.content \nmsg.payload.chatId = -1001429479181\nmsg.payload.type = 'message'\nmsg.payload.content = 'Temperatura ' + payload + \"° C\"\n\n//msg.payload = payload[0];\nreturn msg;\n\n","outputs":1,"noerr":0,"x":340,"y":1580,"wires":[["a17637b9.bb5c08"]]},{"id":"a17637b9.bb5c08","type":"telegram sender","z":"28db1ee.fa9eae2","name":"Send alarm","bot":"36781658.5a5e4a","x":530,"y":1580,"wires":[[]]}]